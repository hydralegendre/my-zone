
<h1>Pages#home</h1>


<p>Find me in app/views/pages/home.html.erb</p>



<% if user_signed_in? %>

<!-- SIGNED IN  -->
<!-- NAVBAR -->
<div class="row">
  <div class="col-xs-12">
    <div class="navbar_newsfeed">
      <h1>MyZone</h1>
        <div class="navbar_right">
          <%= link_to user_path(current_user) do %>
          <%= image_tag 'benoit.jpg', class:"avatar_navbar" %>
          <% end %>&nbsp;&nbsp;&nbsp;
          <%= link_to href: '' do %>
          <%= image_tag 'logout', height:29, weight:29 %>
          <% end %>&nbsp;&nbsp;&nbsp;
        </div>
    </div>
  </div>
</div>

<!-- --  -->
  <!-- WRITE A POST -->
  <div class="write-post-card">
    <!-- AVATAR -->
    <div class="row">
      <div class="col-xs-1">
        <div class="write-post-avatar">
          <%= image_tag("logo", class:"avatar_post")%>
        </div>
      </div>
    </div>
    <!-- WRITE  -->
    <div class="row">
      <div class="cols-xs-11">
        <a href="#">
          <div class="write-post-message">
            <p>
            <%= link_to "Write a post...", new_post_path %>
            </p>
          </div>
        </a>
      </div>
    </div>
  </div>
  <!-- -- -->

<!-- MAIN CARD -->
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <div class="main-card-newsfeed">

          <!-- AVATAR -->
          <div class="avatar-interest-newsfeed">
            <a href="#">
              <%= image_tag("benoit rond.jpg", class:"avatar_interest")%>
            </a>
          </div>

          <!-- CARD ZONE -->
          <a href="#">
            <div class="card-zone-newsfeed">
              <div class="zone-logo-newsfeed">
              </div>
              <div class="zone-name-newsfeed">
                <div class="name-newsfeed">
                  <p>Zone 1</p>
                </div>
              </div>
            </div>
          </a>

          <!-- BANDEAU INTEREST -->
          <div class="bandeau-interest">
            <p>Interest</p>
          </div>
          <div id="triangle"></div>

          <!-- Name -->
          <a href="#">
            <p id="full-name-post">User name</p>
          </a>
          <!-- Time spent -->
          <p id="time-spent-post">XX min.</p>
          <!-- message -->
          <p id="post-message">This is my post message</p>

          <!-- PHOTO -->
           <%= image_tag("euratech.jpg", id:"post-picture-newsfeed")%>

          <!-- GOODS & COMMENTS RESULTS -->
            <div class="interaction-results-wrapper">

              <a href="#">
                <p id= "interaction-results-good">X goods</p>
              </a>

              <a href="#">
                <p id= "interaction-results-comment">X comments</p>
              </a>
            </div>


          <!-- DIVIDER -->

          <div class="row">
            <div class="col-xs-12">
              <div class="line"></div>
            </div>
          </div>

          <!-- GOOD COMMENT SHARE INTERATIONS -->


          <div class="interactions-buttons">

            <div id="good">
              <a href="#">
                <div class="row interaction-row">
                  <div class="col-xs-3">
                    <i class="far fa-thumbs-up"></i>
                  </div>
                  <div class="col-xs-3">
                    <p>Good</p>
                  </div>
                </div>
              </a>
            </div>

            <div id="comment">
              <a href="#">
                <div class="row interaction-row">
                  <div class="col-xs-3">
                    <i class="far fa-comment-dots"></i>
                  </div>
                  <div class="col-xs-3">
                    <p>Comment</p>

                  </div>
                </div>
              </a>
            </div>

            <div id="share">
              <a href="#">
                <div class="row interaction-row">
                  <div class="col-xs-3">

                    <i class="far fa-share-square"></i>
                  </div>
                  <div class="col-xs-3">
                    <p>Share</p>

                  </div>
                </div>
              </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- -- -->

  <!-- NAVBAR BOTTOM -->
  <div class="row">
    <div class="col-xs-12">
      <div class="navbar_newsfeed_bottom navbar-fixed-bottom">
            <%= link_to href: '' do %>
              <i class="fas fa-home"></i>
            <% end %>
            <%= link_to href: '' do %>
              <i class="fas fa-comment-dots"></i>
            <% end %>
            <%= link_to href: '' do %>
              <i class="fas fa-bell"></i>
            <% end %>
      </div>
    </div>
  </div>
  <!-- -- -->

  <h1><%= current_user.id %></h1>

  <%= link_to "Publish Post", new_post_path %>

  <% current_user.zones.each do |my_zone| %>
    <% Zone.near(my_zone.address, my_zone.radius/1000).each do |in_zone| %>
      <% in_zone.posts.where(interest_tag: my_zone.interest_tags).each do |post| %>
<!-- Here should be all the posts published in the zone (whose epicenter is inside the zone)
 -->
        <ul>
         <li>Content:<%= post.content %></li>
         <li>Photo of post<%= post.photo if post.photo.blank? == false %></li>
         <li>Zone title<%= post.zone.title %></li>
         <li>Zone interest<%= post.interest_tag.title %></li>
         <li>Post author avatar<%= post.user.avatar_url %><%= link_to "Avatar", user_path(post.user) %></li>
         <li>Post author name<%= post.user.firstname + ' ' + post.user.lastname %></li>
         <li>Post update time <%= post.updated_at %></li>
         <li><%= post.goods.where(is_good: true).size %> goods</li>
         <li><%= post.comments.size %> comments</li>
        </ul>
        <p id="comment_counter"><%= pluralize post.comments.size, "comment" %></p>
        <p><span id="good_counter_<%= post.id %>"><%= post.goods.where(is_good: true).size %></span> good</p>

        <%= link_to good_post_path(post, is_good: true), method: :post, remote: true do %>
          <i class="fas fa-thumbs-up" id="submmit_good" onclick="sendTheAJAX()"></i>
          <span id="test1"></span>
        <% end %>

       <!--  <script>
          var b = 1;
          function sendTheAJAX(){
            if (b%2 === 1) {
              document.getElementById('good_counter_<%= post.id %>').textContent = parseInt(document.getElementById('good_counter').textContent) + 1
            }
            else {
              document.getElementById('good_counter_<%= post.id %>').textContent = parseInt(document.getElementById('good_counter').textContent) - 1
            };
            b += 1;
          }
        </script> -->

        <%= link_to "Add comment", new_post_comment_path(post.id), class: "add_comment", data: { 'post-id' => post.id } %>

<!--         <div class="commentForm" style="display: none" data-post-id="<%= post.id %>">
          <%= simple_form_for([post, Comment.new], remote: true) do |form| %>
            <%= form.input :content,
                          required: true,
                          autofocus: true %>
            <%= form.input :photo %>
            <%= form.button :submit, class: "submit_comment" %>
          <% end %>
        </div> -->

        <ul>
          <% post.comments.order(created_at: :desc).first(3).each do |comment|  %>
          <li>
            <%= comment.user.id %> | <%= comment.user.firstname %> | <%= comment.user.lastname %>
            <%= comment.content %>
            <%= comment.photo if comment.photo.blank? == false %>
          </li>
          <% end  %>
        </ul>

     <!--    <div class="commentForm">
          <% comment = Comment.new %>
          <%= simple_form_for([post, comment], remote: true) do |form| %>
            <%= form.input :content,
                          required: true,
                          autofocus: true %>
            <%= form.input :photo %>
            <%= form.hidden_field :user_id, value: current_user.id %>
            <%= form.hidden_field :post_id, value: post.id %>
            <%= form.button :submit, class: "submit_comment" %>
          <% end %>

        </div> -->

      <% end %>
    <% end %>
  <% end %>

  <% else %> <!-- user without account -->
<!-- Page 1 -->
<!-- navbar -->
  <div class="row">
    <div class="col-xs-12">
      <div class="navbar_signup">
        <h1>MyZone</h1>
          <div class="navbar_right">
            <a href="#">Sign in</a>&nbsp;&nbsp;&nbsp; <!-- Ces codes sont des espaces -->
            <a href="#">Sign up</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </div>
      </div>
    </div>
  </div>


<!-- content -->
  <div class="banner_landin" style="background-image: linear-gradient(-225deg, rgba(196, 196, 196, 0.8) 50%, rgba(196, 196, 196, 0.8) 50%), url(<%= image_path 'background_signin'%>);">
    <div class="banner_content">
      <h5>Get connected in local</h5>
        <br>
          <br>
      <a href="" class="button_sign_in">Sign up</a>
    </div>
  </div>
  <!-- <div class="container_landin_create">
    <div class="container_landin_create_left">
      <div></div>
      <div><%= image_tag 'icon_landin', class:"icon_landin" %></div>
    </div>
    <div class="container_landin_create_middle">
      <h4><b>Create your zone(s)</b></h4>
      <h4>(private)</h4>
    </div>
    <div class="container_landin_create_right">
      <%= image_tag 'map_signin_example', style:"border-radius:15px"%>
    </div>
  </div> -->
<!-- Page Ã  afficher en scroll   -->
<!-- define interests -->
  <!-- <div class="container_landin_create">
      <div class="container_landin_create_left">
        <div></div>
        <div><%= image_tag 'scrollup', class:"icon_scroll" %></div>
      </div>
      <div class="container_landin_create_middle">
        <h4><b>Define your zone's interests</b></h4>
      </div>
      <div class="container_landin_create_right">
        <%= image_tag 'map_signin_example', style:"border-radius:15px"%>
      </div>
    </div> -->


<!-- you are set -->
<!--   <div class="container_landin_create">
      <div class="container_landin_set_left">
        <div></div>
        <div><%= image_tag 'scrollup', class:"icon_scroll" %></div>
      </div>
      <div class="container_landin_create_middle">
        <h4><b>Define your zone's interests</b></h4>
      </div>
      <div class="container_landin_create_right">
        <%= image_tag 'map_signin_example', style:"border-radius:15px"%>
      </div>
    </div> -->

  <div class="banner_introduction">
    <%= image_tag 'circle', class:"icon_circle"%>
    <h2>Create your zones</h2>
    <%= image_tag 'zone', class:"photo_landin"%>
  </div>

  <div class="banner_introduction">
    <%= image_tag 'circle', class:"icon_circle"%>
    <h2>Define your zone's interests</h2>
    <%= image_tag 'zone1', class:"photo_landin"%>
  </div>

   <div class="banner_introduction">
    <%= image_tag 'circle', class:"icon_circle"%>
      <h2>You're all set!</h2>
      <%= image_tag 'newsfeed', class:"photo_landin"%>
  </div>

  <div class="banner_introduction_last">
      <h2>You're all set!</h2>
      <h6>You're connected with people who share the same interests in your zones!</h6>
      <br>
      <a href="" class="button_sign_in">Sign up</a>
      <br>
  </div>


<% end  %>

